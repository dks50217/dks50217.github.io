import{U as g}from"./util.js";function I(e){if(!e)return{};let t=e.split("?")[1];if(!t)return{};let o=t.split("&");if(!o)return{};let n={};for(let c=0;c<o.length;c++){let r=o[c].split("="),i=r[0],f=r[1];n[i]?(n[i]=Array.isArray(n[i])?n[i]:[n[i]],n[i].push(f)):n[i]=f}return n}const s=I(location.href),p={cafe:"https://cafemaker.wakingsands.com",xivapi:"https://xivapi.com"};var u,h;const a={first:((u=s==null?void 0:s.api)==null?void 0:u.toLowerCase())==="xivapi"?{site:p.xivapi}:{site:p.cafe},second:((h=s==null?void 0:s.api)==null?void 0:h.toLowerCase())==="xivapi"?{site:p.cafe}:{site:p.xivapi}},m={2:{ActionCategoryTargetID:8,Icon:"/i/000000/000123.png"},3:{ActionCategoryTargetID:10,Icon:"/i/000000/000104.png"},4:{ActionCategoryTargetID:5,Icon:"/i/000000/000118.png"},7:{ActionCategoryTargetID:1,Icon:"/i/000000/000101.png"},8:{ActionCategoryTargetID:1,Icon:"/i/000000/000101.png"},25756:{ActionCategoryTargetID:4,Icon:"/i/003000/003090.png"}};async function $(e,t,o=["ID","Icon","ActionCategoryTargetID"]){return Object.hasOwn(m,t)?Promise.resolve(Object.assign({ActionCategoryTargetID:0,ID:t,Icon:"/i/000000/000405.png"},m[t])):await fetch(`${a.first.site}/${e}/${t}?columns=${o.join(",")}`,{mode:"cors"}).then(n=>n.json())||await fetch(`${a.second.site}/${e}/${t}?columns=${o.join(",")}`,{mode:"cors"}).then(n=>n.json())||Promise.resolve({ActionCategoryTargetID:0,ID:t,Icon:"/i/000000/000405.png"})}async function y(e,t=!1){return e.length===0?Promise.resolve(""):l(`${a.first.site}${e}`).catch(()=>l(`${a.second.site}${e}`).catch(()=>Promise.resolve("https://cafemaker.wakingsands.com/i/000000/000405.png"))).then(o=>o.replace(/(\d{6})\/(\d{6})\.png$/,(n,c,r)=>`${c}/${t?"hq/":""}${r}.png`))}async function C(e){return l(`${a.first.site}/cj/companion/${g.nameToFullName(g.jobEnumToJob(e)).en}.png`).catch(()=>l(`${a.second.site}/cj/companion/${g.nameToFullName(g.jobEnumToJob(e)).en}.png`).catch(()=>Promise.resolve("https://cafemaker.wakingsands.com/cj/companion/none.png")))}function l(e){return new Promise(function(t,o){let n=new Image;n.src=e,n.onload=()=>t(e),n.onerror=()=>o()})}async function v(e){return $("action",e,["Icon"]).then(t=>y((t==null?void 0:t.Icon)??""))}async function j(e){const t=/^[\u4e00-\u9fa5]/.test(e);return fetch(`https://${t?"cafemaker.wakingsands.com":"xivapi.com"}/search?filters=IsPlayerAction=1,ClassJobLevel>0&indexes=action&string=${encodeURIComponent(e)}`).then(o=>o.json()).then(o=>{var n;return(n=o.Results)==null?void 0:n[0]})}export{j as a,C as b,v as c,$ as d,y as g,s as p};
